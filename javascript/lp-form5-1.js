!function(){window.module=window.module||{},window.module.lp=window.module.lp||{},window.module.lp.form=window.module.lp.form||{},window.module.lp.form.data=null,window.lp=window.lp||{},lp.form=lp.form||{},lp.form.main=lp.form.main||{},lp.jQuery(document).ready(function(){lp.form.main.start()}),lp.form.main=function(){var e,t,o,r,n,i=function(){window.module.lp.form.data&&(a(),U(),d())},a=function(){l(),u()},l=function(){e="#"+window.module.lp.form.data.formContainerId,t="#"+window.module.lp.form.data.formButtonId,n=e+" form"},u=function(){o="#"+window.module.lp.form.data.errorContainerId,r=o+" ul"},d=function(){k(),p(),R(),H()},p=function(){lp.jQuery("form").keypress(function(e){13===e.which&&"textarea"!==e.target.nodeName.toLowerCase()&&(e.preventDefault(),lp.jQuery("div.lp-pom-form form").submit())})},s=function(){var t=lp.jQuery(o).outerWidth(!0),r=lp.jQuery(e).outerWidth(!0),n=r+t,i=Math.min(lp.jQuery(window).width(),window.innerWidth);i>n?m(r):c()},m=function(t){var r=lp.jQuery(e).offset(),n=r.left+t+16,i=Math.min(lp.jQuery(document).width(),window.innerWidth),a=i-n,l=296,u=280>a,d=u?r.left-l:n;if(d>0){var p=lp.jQuery(o);p.css({left:d+"px",top:Math.max(r.top,lp.jQuery(document).scrollTop()+4)+"px",width:"280px"}),window.onscroll=function(){f(r,p)}}else c()},f=function(t,o){var r=o.offset().top,n=Math.round(r+o.innerHeight()),i=lp.jQuery(e).innerHeight(),a=t.top+i;o.css(n>a&&t.top<lp.jQuery(document).scrollTop()?{position:"absolute"}:t.top<lp.jQuery(document).scrollTop()?{position:"absolute",top:lp.jQuery(document).scrollTop()}:{position:"absolute",top:t.top})},c=function(){lp.jQuery(o).css({position:"fixed",left:"0px",right:"0px",top:"0px"})},w=function(e){return e?e.replace(/\?/g,"&"):""},h=function(e){return new RegExp(/\?/).test(e)?"&":"?"},y=function(e,t){return e.url+h(e.url)+lp.jQuery(t).serialize()+w(window.location.search)},g=function(e){var t="screen and (max-width: 600px)";return window.matchMedia(t).matches&&e.size.mobile},j=function(e){var t=g(e)?"mobile":"desktop";return e.size[t]?{width:e.size[t].width,height:e.size[t].height}:{width:e.size.width,height:e.size.height}},Q=function(e,t){b(e,t)},v=function(e){return"pageId"===e.name||"pageVariant"===e.name||/^ubafs-\w+/.test(e.name)?null:e},b=function(e){var t="";if(window.module.lp.form.data.passParams){var o=/\?/,r=o.test(e)?"&":"?",n=lp.jQuery("form").serializeArray();t=r+lp.jQuery.param(lp.jQuery.map(n,v))}return alert(e+t),e+t},x=function(){lp.jQuery(t).removeClass("disabled")},C=function(){lp.jQuery(t).addClass("disabled")},I=function(){return lp.jQuery(t).hasClass("disabled")},A=function(e){var t=e.getAttribute("action");if("object"==typeof t&&1===t.nodeType){var o=t.parentNode,r=o.removeChild(t);t=A(e),o.appendChild(r)}return t},z=function(e,t){var o=e.getAttribute("action");if("object"==typeof o&&1===o.nodeType){var r=o.parentNode,n=r.removeChild(o);o=z(e,t),r.appendChild(n)}e.setAttribute("action",t)},M=function(e){return lp.jQuery.each(e,function(t,o){o.email&&(e[t]={required:{depends:function(){return/\W$/.test(lp.jQuery(this).val())&&lp.jQuery(this).val(lp.jQuery.trim(lp.jQuery(this).val())),o.required}},email:!0})}),e},W=function(e){lp.jQuery.validator.addMethod("phone",function(t,o){return t=t.replace(/([. \-()+])/g,""),"uk"===e?this.optional(o)||t.length>9&&t.match(/^((44?(0)?)|(0))([0-9]{3,4}){3}$/):"australian"===e?this.optional(o)||t.length>5&&t.length<16&&t.match(/^((0|61)(2|4|3|7|8)){0,1}[0-9]{2}[0-9]{2}[0-9]{1}[0-9]{3}$/):"generic"===e?this.optional(o)||t.length>5&&t.length<16&&!isNaN(t):this.optional(o)||t.length>9&&t.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number")},T=function(e){var t=e.validationType,o=["generic","australian","uk","north-american"];t&&lp.jQuery.inArray(t,o)>-1&&W(t)},P=function(){var e=window.module.lp.form.data.confirmAction;return-1===lp.jQuery.inArray(e,["url","post"])},U=function(){s(),T(window.module.lp.form.data),lp.jQuery(n).validate({rules:M(window.module.lp.form.data.validationRules),messages:window.module.lp.form.data.validationMessages,errorContainer:o,errorLabelContainer:r,wrapper:"li",onFocusOut:s,invalidHandler:s,focusInvalid:!1,submitHandler:function(e){I()||(C(),lp.jQuery.ajax({url:A(lp.jQuery(e).get(0))+"&lp-form-submit-method=ajax",type:"POST",data:lp.jQuery(e).serialize(),debug:!0,error:function(){alert(window.module.lp.form.data.errorMessage||"We're sorry the form could not be submitted because something went wrong. Please try again.")},success:function(t){t.protected_assets&&(window.module.lp.form.responseData={protectedAssets:t.protected_assets});var o=lp.jQuery("#"+window.module.lp.form.data.formContainerId+" form");switch(window.module.lp.form.data.confirmAction){case"url":{y(window.module.lp.form.data.confirmData,e)}return alert(String(rurl)),!0;case"message":alert(window.module.lp.form.data.confirmData);break;case"modal":Q(window.module.lp.form.data.confirmData,e);break;case"post":o.unbind(),z(o.get(0),window.module.lp.form.data.confirmData),o.submit();break;case"submit":var r=window.module.lp.form.data.confirmData.url+"?"+$("div.lp-pom-form form").serialize();window.location.href=r}},complete:function(){P()&&(x(),e.blur(),e.reset())}}))}})},k=function(){var e,t=window.lp.form.main.getUrlParams(),o=lp.jQuery("#"+window.module.lp.form.data.formContainerId+" form"),r=["pageid","pagevariant"];for(var n in t){e=lp.jQuery(o).find("input[name="+n+"]")[0]||lp.jQuery(o).find("textarea[name="+n+"]")[0];var i=lp.jQuery.inArray(r,n.toLowerCase());"undefined"!=typeof e&&-1===i&&("text"===e.type||"hidden"===e.type||"textarea"===e.type)&&(e.value=D(t[n]))}},D=function(e){try{return decodeURIComponent(e)}catch(t){return decodeURIComponent(encodeURIComponent(unescape(e)))}},H=function(){if(lp.jQuery.browser.msie&&parseInt(lp.jQuery.browser.version,10)<9){var e;lp.jQuery("select").each(function(){e=lp.jQuery(this),e.data("origWidth",e.outerWidth())}).mousedown(function(){lp.jQuery(this).css("width","auto")}).bind("blur change",function(){e=lp.jQuery(this),e.css("width",e.data("origWidth"))})}},L=function(e,t){if(e.offsetHeight>t)for(var o=1,r=30,n=parseInt(e.style.width,10);lp.jQuery(e).height()>t&&r>o;)e.style.width=n+o+"px",o++},N=function(){return window.location.href},O=function(){var e,t={},o=this.getWindowLocation(),r=o.slice(o.indexOf("?")+1).split("&");for(e=0;e<r.length;e++){var n=r[e].split("="),i=n[0],a=n[1]||"";t.hasOwnProperty(i)?Array.isArray(t[i])?t[i].push(a):t[i]=[t[i],a]:t[i]=a}return t},R=function(){lp.jQuery(".lp-pom-form label").each(function(e,t){if(t.style.height){var o=parseInt(t.style.height,10);t.style.height="auto",L(t,o)}})};return{getOperatorToUseFromUrl:h,getParamsForSuccessModal:w,formFilter:v,buildSuccessModalUrl:y,getWindowLocation:N,getUrlParams:O,getModalSize:j,start:i}}()}();