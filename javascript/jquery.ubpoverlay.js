!function(e){var t,i,a,n,o,r,d,l,s,p,h,c,u,v=0,g={},f=[],b=0,y={},w=[],m=null,x=new Image,I=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,C=/[^\.]\.(swf)\s*$/i,k=1,O=0,j="",T=!1,S=e.extend(e("<div/>")[0],{prop:0}),A=e.browser.msie&&e.browser.version<7&&!window.XMLHttpRequest,D=function(){i.hide(),x.onerror=x.onload=null,m&&m.abort(),t.empty()},F=function(){return!1===g.onError(f,v,g)?(i.hide(),void(T=!1)):(g.titleShow=!1,g.width="auto",g.height="auto",t.html('<p id="ubpoverlay-error">The requested content cannot be loaded.<br />Please try again later.</p>'),void N())},E=function(){var a,n,o,d,l,s,p=f[v];if(D(),g=e.extend({},e.fn.ubpoverlay.defaults,"undefined"==typeof e(p).data("ubpoverlay")?g:e(p).data("ubpoverlay")),s=g.onStart(f,v,g),s===!1)return void(T=!1);if("object"==typeof s&&(g=e.extend(g,s)),o=g.title||(p.nodeName?e(p).attr("title"):p.title)||"",p.nodeName&&!g.orig&&(g.orig=e(p).children("img:first").length?e(p).children("img:first"):e(p)),""===o&&g.orig&&g.titleFromAlt&&(o=g.orig.attr("alt")),a=g.href||(p.nodeName?e(p).attr("href"):p.href)||null,(/^(?:javascript)/i.test(a)||"#"==a)&&(a=null),g.type?(n=g.type,a||(a=g.content)):g.content?n="html":a&&(n=a.match(I)?"image":a.match(C)?"swf":e(p).hasClass("iframe")?"iframe":0===a.indexOf("#")?"inline":"ajax"),!n)return void F();switch("inline"==n&&(p=a.substr(a.indexOf("#")),n=e(p).length>0?"inline":"ajax"),g.type=n,g.href=a,g.title=o,g.autoDimensions&&("html"==g.type||"inline"==g.type||"ajax"==g.type?(g.width="auto",g.height="auto"):g.autoDimensions=!1),g.modal&&(g.overlayShow=!0,g.hideOnOverlayClick=!1,g.hideOnContentClick=!1,g.enableEscapeButton=!1,g.showCloseButton=!1),g.padding=parseInt(g.padding,10),g.margin=parseInt(g.margin,10),t.css("padding",g.padding+g.margin),e(".ubpoverlay-inline-tmp").unbind("ubpoverlay-cancel").bind("ubpoverlay-change",function(){e(this).replaceWith(r.children())}),n){case"html":t.html(g.content),N();break;case"inline":if(e(p).parent().is("#ubpoverlay-content")===!0)return void(T=!1);e('<div class="ubpoverlay-inline-tmp" />').hide().insertBefore(e(p)).bind("ubpoverlay-cleanup",function(){e(this).replaceWith(r.children())}).bind("ubpoverlay-cancel",function(){e(this).replaceWith(t.children())}),e(p).appendTo(t),N();break;case"image":T=!1,e.ubpoverlay.showActivity(),x=new Image,x.onerror=function(){F()},x.onload=function(){T=!0,x.onerror=x.onload=null,B()},x.src=a;break;case"swf":g.scrolling="no",d='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+g.width+'" height="'+g.height+'"><param name="movie" value="'+a+'"></param>',l="",e.each(g.swf,function(e,t){d+='<param name="'+e+'" value="'+t+'"></param>',l+=" "+e+'="'+t+'"'}),d+='<embed src="'+a+'" type="application/x-shockwave-flash" width="'+g.width+'" height="'+g.height+'"'+l+"></embed></object>",t.html(d),N();break;case"ajax":T=!1,e.ubpoverlay.showActivity(),g.ajax.win=g.ajax.success,m=e.ajax(e.extend({},g.ajax,{url:a,data:g.ajax.data||{},error:function(e){e.status>0&&F()},success:function(e,n,o){var r="object"==typeof o?o:m;if(200==r.status){if("function"==typeof g.ajax.win){if(s=g.ajax.win(a,e,n,o),s===!1)return void i.hide();("string"==typeof s||"object"==typeof s)&&(e=s)}t.html(e),N()}}}));break;case"iframe":P()}},N=function(){var i=g.width,a=g.height;i=i.toString().indexOf("%")>-1?parseInt((e(window).width()-2*g.margin)*parseFloat(i)/100,10)+"px":"auto"==i?"auto":i+"px",a=a.toString().indexOf("%")>-1?parseInt((e(window).height()-2*g.margin)*parseFloat(a)/100,10)+"px":"auto"==a?"auto":a+"px",t.wrapInner('<div style="width:'+i+";height:"+a+";overflow: "+("auto"==g.scrolling?"auto":"yes"==g.scrolling?"scroll":"hidden")+';position:relative;"></div>'),g.width=t.width(),g.height=t.height(),P()},B=function(){g.width=x.width,g.height=x.height,e("<img />").attr({id:"ubpoverlay-img",src:x.src,alt:g.title}).appendTo(t),P()},P=function(){var o,h;return i.hide(),n.is(":visible")&&!1===y.onCleanup(w,b,y)?(e.event.trigger("ubpoverlay-cancel"),void(T=!1)):(T=!0,e(r.add(a)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),n.is(":visible")&&"outside"!==y.titlePosition&&n.css("height",n.height()),w=f,b=v,y=g,y.overlayShow?(a.css({"background-color":y.overlayColor,opacity:y.overlayOpacity,cursor:y.hideOnOverlayClick?"pointer":"auto",height:e(document).height()}),a.is(":visible")||(A&&e("select:not(#ubpoverlay-tmp select)").filter(function(){return"hidden"!==this.style.visibility}).css({visibility:"hidden"}).one("ubpoverlay-cleanup",function(){this.style.visibility="inherit"}),a.show())):a.hide(),u=q(),M(),n.is(":visible")?(e(d.add(s).add(p)).hide(),o=n.position(),c={top:o.top,left:o.left,width:n.width(),height:n.height()},h=c.width==u.width&&c.height==u.height,void r.fadeTo(y.changeFade,.3,function(){var i=function(){r.html(t.contents()).fadeTo(y.changeFade,1,H)};e.event.trigger("ubpoverlay-change"),r.empty().removeAttr("filter").css({"border-width":y.padding,width:u.width-2*y.padding,height:g.autoDimensions?"auto":u.height-O-2*y.padding}),h?i():(S.prop=0,e(S).animate({prop:1},{duration:y.changeSpeed,easing:y.easingChange,step:K,complete:i}))})):(n.removeAttr("style"),r.css("border-width",y.padding),"elastic"==y.transitionIn?(c=X(),r.html(t.contents()),n.show(),y.opacity&&(u.opacity=0),S.prop=0,void e(S).animate({prop:1},{duration:y.speedIn,easing:y.easingIn,step:K,complete:H})):("inside"==y.titlePosition&&O>0&&l.show(),r.css({width:u.width-2*y.padding,height:g.autoDimensions?"auto":u.height-O-2*y.padding}).html(t.contents()),void n.css(u).fadeIn("none"==y.transitionIn?0:y.speedIn,H))))},L=function(e){return e&&e.length?"float"==y.titlePosition?'<table id="ubpoverlay-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="ubpoverlay-title-float-left"></td><td id="ubpoverlay-title-float-main">'+e+'</td><td id="ubpoverlay-title-float-right"></td></tr></table>':'<div id="ubpoverlay-title-'+y.titlePosition+'">'+e+"</div>":!1},M=function(){if(j=y.title||"",O=0,l.empty().removeAttr("style").removeClass(),y.titleShow===!1)return void l.hide();if(j=e.isFunction(y.titleFormat)?y.titleFormat(j,w,b,y):L(j),!j||""===j)return void l.hide();switch(l.addClass("ubpoverlay-title-"+y.titlePosition).html(j).appendTo("body").show(),y.titlePosition){case"inside":l.css({width:u.width-2*y.padding,marginLeft:y.padding,marginRight:y.padding}),O=l.outerHeight(!0),l.appendTo(o),u.height+=O;break;case"over":l.css({marginLeft:y.padding,width:u.width-2*y.padding,bottom:y.padding}).appendTo(o);break;case"float":l.css("left",-1*parseInt((l.width()-u.width-40)/2,10)).appendTo(n);break;default:l.css({width:u.width-2*y.padding,paddingLeft:y.padding,paddingRight:y.padding}).appendTo(n)}l.hide()},z=function(){return(y.enableEscapeButton||y.enableKeyboardNav)&&e(document).bind("keydown.fb",function(t){27==t.keyCode&&y.enableEscapeButton?(t.preventDefault(),e.ubpoverlay.close()):37!=t.keyCode&&39!=t.keyCode||!y.enableKeyboardNav||"INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName||"SELECT"===t.target.tagName||(t.preventDefault(),e.ubpoverlay[37==t.keyCode?"prev":"next"]())}),y.showNavArrows?((y.cyclic&&w.length>1||0!==b)&&s.show(),void((y.cyclic&&w.length>1||b!=w.length-1)&&p.show())):(s.hide(),void p.hide())},H=function(){e.support.opacity||(r.get(0).style.removeAttribute("filter"),n.get(0).style.removeAttribute("filter")),g.autoDimensions&&r.css("height","auto"),n.css("height","auto"),j&&j.length&&l.show(),y.showCloseButton&&d.show(),z(),y.hideOnContentClick&&r.bind("click",e.ubpoverlay.close),y.hideOnOverlayClick&&a.bind("click",e.ubpoverlay.close),e(window).bind("resize.fb",e.ubpoverlay.resize),y.centerOnScroll&&e(window).bind("scroll.fb",e.ubpoverlay.center),"iframe"==y.type&&e('<iframe id="ubpoverlay-frame" name="ubpoverlay-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(e.browser.msie?'allowtransparency="true""':"")+' scrolling="'+g.scrolling+'" src="'+y.href+'"></iframe>').appendTo(r),n.show(),T=!1,e.ubpoverlay.center(),y.onComplete(w,b,y),R()},R=function(){var e,t;w.length-1>b&&(e=w[b+1].href,"undefined"!=typeof e&&e.match(I)&&(t=new Image,t.src=e)),b>0&&(e=w[b-1].href,"undefined"!=typeof e&&e.match(I)&&(t=new Image,t.src=e))},K=function(e){var t={width:parseInt(c.width+(u.width-c.width)*e,10),height:parseInt(c.height+(u.height-c.height)*e,10),top:parseInt(c.top+(u.top-c.top)*e,10),left:parseInt(c.left+(u.left-c.left)*e,10)};"undefined"!=typeof u.opacity&&(t.opacity=.5>e?.5:e),n.css(t),r.css({width:t.width-2*y.padding,height:t.height-O*e-2*y.padding})},W=function(){return[e(window).width()-2*y.margin,e(window).height()-2*y.margin,e(document).scrollLeft()+y.margin,e(document).scrollTop()+y.margin]},q=function(){var e,t=W(),i={},a=y.autoScale,n=2*y.padding;return i.width=y.width.toString().indexOf("%")>-1?parseInt(t[0]*parseFloat(y.width)/100,10):y.width+n,i.height=y.height.toString().indexOf("%")>-1?parseInt(t[1]*parseFloat(y.height)/100,10):y.height+n,a&&(i.width>t[0]||i.height>t[1])&&("image"==g.type||"swf"==g.type?(e=y.width/y.height,i.width>t[0]&&(i.width=t[0],i.height=parseInt((i.width-n)/e+n,10)),i.height>t[1]&&(i.height=t[1],i.width=parseInt((i.height-n)*e+n,10))):(i.width=Math.min(i.width,t[0]),i.height=Math.min(i.height,t[1]))),i.top=parseInt(Math.max(t[3]-20,t[3]+.5*(t[1]-i.height-40)),10),i.left=parseInt(Math.max(t[2]-20,t[2]+.5*(t[0]-i.width-40)),10),i},Q=function(e){var t=e.offset();return t.top+=parseInt(e.css("paddingTop"),10)||0,t.left+=parseInt(e.css("paddingLeft"),10)||0,t.top+=parseInt(e.css("border-top-width"),10)||0,t.left+=parseInt(e.css("border-left-width"),10)||0,t.width=e.width(),t.height=e.height(),t},X=function(){var t,i,a=g.orig?e(g.orig):!1,n={};return a&&a.length?(t=Q(a),n={width:t.width+2*y.padding,height:t.height+2*y.padding,top:t.top-y.padding-20,left:t.left-y.padding-20}):(i=W(),n={width:2*y.padding,height:2*y.padding,top:parseInt(i[3]+.5*i[1],10),left:parseInt(i[2]+.5*i[0],10)}),n},$=function(){return i.is(":visible")?(e("div",i).css("top",-40*k+"px"),void(k=(k+1)%12)):void clearInterval(h)};e.fn.ubpoverlay=function(t){return e(this).length?(e(this).data("ubpoverlay",e.extend({},t,e.metadata?e(this).metadata():{})).unbind("click.fb").bind("click.fb",function(t){if(t.preventDefault(),!T){T=!0,e(this).blur(),f=[],v=0;var i=e(this).attr("rel")||"";i&&""!=i&&"nofollow"!==i?(f=e("a[rel="+i+"], area[rel="+i+"]"),v=f.index(this)):f.push(this),E()}}),this):this},e.ubpoverlay=function(t){var i;if(!T){if(T=!0,i="undefined"!=typeof arguments[1]?arguments[1]:{},f=[],v=parseInt(i.index,10)||0,e.isArray(t)){for(var a=0,n=t.length;n>a;a++)"object"==typeof t[a]?e(t[a]).data("ubpoverlay",e.extend({},i,t[a])):t[a]=e({}).data("ubpoverlay",e.extend({content:t[a]},i));f=jQuery.merge(f,t)}else"object"==typeof t?e(t).data("ubpoverlay",e.extend({},i,t)):t=e({}).data("ubpoverlay",e.extend({content:t},i)),f.push(t);(v>f.length||0>v)&&(v=0),E()}},e.ubpoverlay.showActivity=function(){clearInterval(h),i.show(),h=setInterval($,66)},e.ubpoverlay.hideActivity=function(){i.hide()},e.ubpoverlay.next=function(){return e.ubpoverlay.pos(b+1)},e.ubpoverlay.prev=function(){return e.ubpoverlay.pos(b-1)},e.ubpoverlay.pos=function(e){T||(e=parseInt(e),f=w,e>-1&&e<w.length?(v=e,E()):y.cyclic&&w.length>1&&(v=e>=w.length?0:w.length-1,E()))},e.ubpoverlay.cancel=function(){T||(T=!0,e.event.trigger("ubpoverlay-cancel"),D(),g.onCancel(f,v,g),T=!1)},e.ubpoverlay.close=function(){function t(){a.fadeOut("fast"),l.empty().hide(),n.hide(),e.event.trigger("ubpoverlay-cleanup"),r.empty(),y.onClosed(w,b,y),w=g=[],b=v=0,y=g={},T=!1}if(!T&&!n.is(":hidden")){if(T=!0,y&&!1===y.onCleanup(w,b,y))return void(T=!1);if(D(),e(d.add(s).add(p)).hide(),e(r.add(a)).unbind(),e(window).unbind("resize.fb scroll.fb"),e(document).unbind("keydown.fb"),r.find("iframe").attr("src",A&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),"inside"!==y.titlePosition&&l.empty(),n.stop(),"elastic"==y.transitionOut){c=X();var i=n.position();u={top:i.top,left:i.left,width:n.width(),height:n.height()},y.opacity&&(u.opacity=1),l.empty().hide(),S.prop=1,e(S).animate({prop:0},{duration:y.speedOut,easing:y.easingOut,step:K,complete:t})}else n.fadeOut("none"==y.transitionOut?0:y.speedOut,t)}},e.ubpoverlay.resize=function(){a.is(":visible")&&a.css("height",e(document).height()),e.ubpoverlay.center(!0)},e.ubpoverlay.center=function(){var e,t;T||(t=arguments[0]===!0?1:0,e=W(),(t||!(n.width()>e[0]||n.height()>e[1]))&&n.stop().animate({top:parseInt(Math.max(e[3]-20,e[3]+.5*(e[1]-r.height()-40)-y.padding)),left:parseInt(Math.max(e[2]-20,e[2]+.5*(e[0]-r.width()-40)-y.padding))},"number"==typeof arguments[0]?arguments[0]:200))},e.ubpoverlay.init=function(){e("#ubpoverlay-wrap").length||(e("body").append(t=e('<div id="ubpoverlay-tmp"></div>'),i=e('<div id="ubpoverlay-loading"><div></div></div>'),a=e('<div id="ubpoverlay-overlay"></div>'),n=e('<div id="ubpoverlay-wrap"></div>')),o=e('<div id="ubpoverlay-outer"></div>').append('<div class="ubpoverlay-bg" id="ubpoverlay-bg-n"></div><div class="ubpoverlay-bg" id="ubpoverlay-bg-ne"></div><div class="ubpoverlay-bg" id="ubpoverlay-bg-e"></div><div class="ubpoverlay-bg" id="ubpoverlay-bg-se"></div><div class="ubpoverlay-bg" id="ubpoverlay-bg-s"></div><div class="ubpoverlay-bg" id="ubpoverlay-bg-sw"></div><div class="ubpoverlay-bg" id="ubpoverlay-bg-w"></div><div class="ubpoverlay-bg" id="ubpoverlay-bg-nw"></div>').appendTo(n),o.append(r=e('<div id="ubpoverlay-content"></div>'),d=e('<a id="ubpoverlay-close"></a>'),l=e('<div id="ubpoverlay-title"></div>'),s=e('<a href="javascript:;" id="ubpoverlay-left"><span class="ubpoverlay-ico" id="ubpoverlay-left-ico"></span></a>'),p=e('<a href="javascript:;" id="ubpoverlay-right"><span class="ubpoverlay-ico" id="ubpoverlay-right-ico"></span></a>')),d.click(e.ubpoverlay.close),i.click(e.ubpoverlay.cancel),s.click(function(t){t.preventDefault(),e.ubpoverlay.prev()}),p.click(function(t){t.preventDefault(),e.ubpoverlay.next()}),e.fn.mousewheel&&n.bind("mousewheel.fb",function(t,i){T?t.preventDefault():(0==e(t.target).get(0).clientHeight||e(t.target).get(0).scrollHeight===e(t.target).get(0).clientHeight)&&(t.preventDefault(),e.ubpoverlay[i>0?"prev":"next"]())}),e.support.opacity||n.addClass("ubpoverlay-ie"),A&&(i.addClass("ubpoverlay-ie6"),n.addClass("ubpoverlay-ie6"),e('<iframe id="ubpoverlay-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(o)))},e.fn.ubpoverlay.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},e(document).ready(function(){e.ubpoverlay.init()})}(jQuery);